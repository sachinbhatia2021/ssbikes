<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
  <meta http-equiv="X-UA-Compatible" content="IE edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <link rel="icon" type="image/x-icon" href="../static/logo.jpeg">
  <link href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../static/nav_foot.css">
  <link
    href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Nanum+Brush+Script&family=Open+Sans:wght@600&family=Poppins:wght@200;400;500;600;700;900&family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500&display=swap"
    rel="stylesheet" />
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
  

  <title>Inverter Analytics</title>
</head>
<style>
  .box {
    height: 120px;
    width: 120px;
    margin-top: 55px;
    margin-left: 130px;
    transform: translate(-50%, -50%);
    background: #f0efef;
    border-radius: 100%;
    overflow: hidden;
    position: relative;
  }

  .box .percent {
    position: absolute;
    left: 0;
    top: 0;
    z-index: 3;
    width: 100%;
    height: 100%;
    display: -webkit-flex;
    align-items: center;
    justify-content: center;
    color: #000000;
    font-size: 34px;
  }

  .box .water {
    left: 0;
    top: 0;
    z-index: 2;
    width: 100%;
    height: 100%;
    transform: translate(0, 100%);
    background: #4D6DE3;
    transition: all 0.3s;
  }

  .box .water_wave {
    width: 200%;
    position: absolute;
    bottom: 100%;
  }

  .box .water_wave_back {
    right: 0;
    fill: #C7EEFF;
    -webkit-animation: wave-back 1.4s infinite linear;
    animation: wave-back 1.4s infinite linear;
  }

  .box .water_wave_front {
    left: 0;
    fill: #4D6DE3;
    margin-bottom: -1px;
    -webkit-animation: wave-front 0.7s infinite linear;
    animation: wave-front 0.7s infinite linear;
  }

  @-webkit-keyframes wave-front {
    100% {
      transform: translate(-50%, 0);
    }
  }

  @keyframes wave-front {
    100% {
      transform: translate(-50%, 0);
    }
  }

  @-webkit-keyframes wave-back {
    100% {
      transform: translate(50%, 0);
    }
  }

  @keyframes wave-back {
    100% {
      transform: translate(50%, 0);
    }
  }

  @media (max-width: 576px) {
    .box {
      margin-left: 200px;
    }

  }

  .full-width4 {
    padding-left: 10px;
    border-radius: 8px;
    margin-left: 30px;
    margin-top: 40px;
    background-color: #eeeef2;
    padding-top: 40px;
    width: 97%;
    height: 180px;
    margin-bottom: 10px;
    border-left: 6px solid #460abf;
  }
.full-width44 {
    padding-left: 10px;
    border-radius: 8px;
    margin-left: -10px;
    margin-top: 40px;
    background-color: #eeeef2;
    padding-top: 40px;
    width: 100%;
    height: 220px;
    margin-bottom: 10px;
    border-left: 6px solid #460abf;
  }
  .dates {
    font-size: 13px;
    color: rgb(203, 9, 9);
  }

  .submitbtn {
    margin-right: 30px;
  }

  .datess {
    display: flex;
    justify-content: right;
    gap: 100px;
    margin-right: 130px;
  }

  .chart1 {
    height: auto;
    background-color: #f2f4f8;
    margin-left: -15px;
    margin-top: 40px;
    padding: 20px;
    border: none;
    box-shadow: 1px 1px 10px 10px rgba(0, 0, 0, 0.1);
    transition: transform 0.7s ease;
    overflow: hidden;
  }
  .chart2 {
    height: auto;
    background-color: #f2f4f8;
    width: 100%;
    border: none;
    box-shadow: 1px 1px 10px 10px rgba(0, 0, 0, 0.1);
    transition: transform 0.7s ease;
    overflow: hidden;
  }
  .powerstationparameters{
            font-size: 30px;
            display: flex;
            justify-content:center ;

          }
          .parameters{
  background-color:  rgb(212, 208, 208);
  padding: 8px;
  height: 80px;
  width: 120px;
  font-weight: 600;
      box-shadow: 5px 5px 10px 8px rgba(12, 12, 12, 0.1);

}

  @media(max-width:576px) {
    .datess {
      display: block;
      justify-content: center;
      gap: 100px;
      /* margin-left: -50px; */
    }
    .parameters{
  background-color:  rgb(212, 208, 208);
  padding: 10px;
  height: 80px;
  width: 100px;
}
  .powerstationparameters{
            font-size: 20px;
            display: flex;
            justify-content:center ;

          }
    .full-width4 {
      border-radius: 8px;
      margin-top: 40px;
      margin-left: 2px;
      background-color: #eeeef2;
      padding-top: 40px;
      width: 100%;
      height: 250px;
      margin-bottom: 10px;
      border-left: 6px solid #460abf;
    }
    .half-width{
      margin-left: 23px;
    }
    .chart1 {
      height: auto;

      margin-left: -10px;
      background-color: #f2f4f8;
      width: 100%;
      padding: 10px;
      border: none;
      transition: transform 0.7s ease;
      overflow: hidden;
    }

    .headinggraph {
      font-size: 12px;
    }
  }
  .acdcflexdiv {
    display: flex;
    justify-content: space-around;
    gap: 20px;
  }

  .dcdiv {
    width: 50%;
    height: auto;
    background-color: white;
    box-shadow: 8px 8px 18px 8px rgba(0, 0, 0, 0.1);

  }

  .dcbox1 {
    padding-top: 50px;
    height: 130px;
    width: 22%;
    background-color: white;
    text-align: center;

    box-shadow: 5px 5px 10px 8px rgba(12, 12, 12, 0.1);
  }

  .title {
    padding: 10px;
    margin-top: 15px;
    text-align: center;
    background-color: #d3d3d3;
    height: 80px;
    width: 100px;
    transform: rotate(270deg);
  }

  /* ac div */
  .acdiv {
    width: 40.5%;
    margin-left: 3%;
    background-color: white;
  }

  .acbox1 {
    height: 150px;
    width: 200px;
  }
/* graph  */
.flexgraph {
          display: flex;
          justify-content: space-between;
        }

        .acdcgraph {
          height: 370px;
          width: 47%;
          margin-top: 20px;
          margin-left: -1%;
        }
    /* home */
    .homediv{
    display: flex;
    justify-content: center;
  }
  .home{
    height: 400px;
    border-radius: 100%;
    width: 70%;
  }
  /*  */
/*   */
  @media(max-width:576px) {
    .acdcflexdiv {
      display: block;

    }
   .homediv{
    display: block;
    justify-content: center;
  }
   .home{
    height: 500px;
    border-radius: 100%;
    width: 100%;
  }
/*  */
    .dcdiv {
      width: 100%;
      padding-top: 10px;
      padding-bottom: 10px;
      height: auto;
      background-color: rgb(125, 158, 248);
    }
    h4{
      font-size: 20px;
    }

    .acdiv {
    width: 99%;
    background-color: white;
  }
  .dcbox1 {
    padding-top: 60px;
    height: 150px;
    width: 140px;
    margin-top: 10px;
    background-color: white;
    text-align: center;
    box-shadow: 5px 5px 10px 8px rgba(12, 12, 12, 0.1);
  }
  .dcbox1 h3{
    font-size: 20px;
  }
  /* graph */
  .flexgraph {
          display: block;
        }

        .acdcgraph {
          height: 370px;
          width: 100%;
          padding: 10px;
          margin-top: 25px;
          margin-left: -13px;
        }
    
  }
  .container1 {
    text-align: center;
  }

  .row {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 20px 0;
  }

  .panel,
  .battery {
    width: 120px;
    height: 120px;
    border: 3px solid black;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }

  .battery {
    background-color: white;
    width: 110px;
    height: 50px;
  }

  .battery::before {
    content: '';
    position: absolute;
    top: 50%;
    right: -15px;
    width: 10px;
    height: 20px;
    background-color: black;
    transform: translateY(-50%);
    border-radius: 2px;
  }

  .wire {
    width: 100px;
    height: 5px;
    background-color: gray;
    margin: 0 10px;
    transition: background-color 0.3s, box-shadow 0.3s;
    position: relative;
  }

  .wire.active {
    background: linear-gradient(to right, rgb(68, 0, 255), rgb(21, 0, 255), red);
    animation: electric-flow 1s linear infinite;
    box-shadow: 0 0 10px rgb(43, 0, 255);
  }
  .charge {
      width: 0%; 
      height: 100%; 
      background-color: green;
      position: absolute;
      left: 0; 
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 18px;
      box-shadow: 0 0 10px green;
      transition: width 0.1s ease-in-out;
    }


  .status {
    font-size: 20px;
    font-weight: bold;
    color: #333;
  }

  .paneldata{
            display: flex;
            justify-content: space-around;
          }
          .boxpanel{
            background-color:#FFFFFF;
            padding: 9px;
            height: 40px;
            width: 100px;
            box-shadow: 5px 5px 10px 8px rgba(12, 12, 12, 0.1);

          }
          .boxpanel:hover{
            background-color: #F2F4F8;
            transform: scale(1.1);
            transition: all 1s;

          }

  .button-container {
    margin-top: 20px;
  }

  button {
    padding: 10px 20px;
    font-size: 16px;
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  button:hover {
    background-color: #0056b3;
  }

  /* Animations */
  @keyframes electric-flow {
    0% {
      background-position: 0 0;
    }

    100% {
      background-position: 100px 0;
    }
  }
  
/* footer */
.footer {
  display: flex;
  justify-content: space-between;
  width: 107.6%;
  background-color: rgb(234, 238, 245);
  padding: 10px;
  bottom: 0;
margin-left: -90px;
right: 0;
}
@media(max-width:576px) {
  .footer {
  display: flex;
  justify-content: space-between;
  width: 127%;
  background-color: rgb(234, 238, 245);
  padding: 10px;
  bottom: 0;
}


}



</style>
<!--  -->
<body>
  <!-- navbar for mobileview -->
  <div class="mobileshow">
    <div class="nav">
      <a href="{{ url_for('dash') }}"><img src="/static/logo.jpeg" class="logo" alt="LOGO" /></a>
      <ul>
        <!-- <li><a href="{{ url_for('data_table') }}" class="ex2">Table</a></li> -->
        <li><a href="{{url_for('alldevices')}}">Devices</a></li>
        <li><a href="#" id="logout-btn">Log Out</a></li>
      </ul>
    </div>
  </div>

  <!-- side navbar -->
  <div class="navbg text-center ">
    <div class="text d-flex">
      <div class="hideicon">
        <a href="{{ url_for('dash') }}" class="ex2 me-2">
          <img class="ms-" src="/static/logo.jpeg" height="50px" style="margin-left: -12px;" alt="">
        </a>
           <a href="{{url_for('dash')}}">
          <h3><i class="fa-solid fa-house"></i></h3>
        </a>
        <a href="{{url_for('alldevices')}}">
          <h3><i class="bi bi-projector"></i></h3>
        </a>
         <a href="{{url_for('users')}}">
          <h3><i class="fa-solid fa-user"></i> </h3>
        </a>
      
       
        <a  onclick="logout()" href="#" id="logout-btn">
          <h3><i class="fa-solid fa-arrow-right-from-bracket"></i></h3>
        </a>
      </div>
      <!-- next textdiv link navbar -->
      <div class="mt-2" style="font-size: 25px;">
        <h4 class="text-light mt-4">Analytics</h4>
          <a href="{{ url_for('dash') }}" class="ex2 mt-4">Home</a>
        <a href="{{url_for('alldevices')}}" class="ex2 mt-3">Devices</a>
        <a href="{{url_for('users')}}" class="ex2 mt-3">Users</a>
        <!-- <a href="{{ url_for('data_table') }}" class="ex2 mt-3">Table</a> -->
        <a  onclick="logout()" href="#" id="logout-btn" class="ex2 mt-3">Log Out</a>
      </div>
    </div>
  </div>

  <!-- Dashboard -->
  <div class="content">
<div  style="text-align: end; margin-right: 15px;"><p > LAST PACKET : {{Dccurrent[1]}}</p>

</div>

<div class="homediv" >
  <div class="">
     <div class="" >
        <br />
<span class="text-center mt-2 sizebox">
  <h4>
 
  <i class="fas fa-lightbulb" style="color: {% if inverterdata[2] > 0.1 %}green{% else %}black{% endif %}; margin-left: 10px;"></i>
</h4>
</span>

        <div class="text-center" >

         <h5> Solar Power</h5><br>
        </div>
      </div><br><br>
        <div class="" >
        <br /><br><br>
<span class="text-center mt-2 sizebox">
  <h4 >
 
  <i class="fas fa-lightbulb" style="color: {% if Accurrent[2] > 0.1 %}blue{% else %}black{% endif %}; margin-left: 10px;"></i>
</h4>
</span>

        <div class="text-center" >
         <h5> Grid Power</h5>
        </div>
      </div>
</div>
<img class="home" src="../static/home.png" alt=""> 

 <div>
            
<span class="text-center mt-2 sizebox"><br>
  <h4>
 
  <i class="fas fa-lightbulb" style="color: {% if inverterdata[2] > 0.1 %}red{% else %}black{% endif %}; margin-left: 10px;"></i>
</h4>
</span>

  <div class="text-center" >
         <h5> Load Status</h5>
        </div>
<!--  -->
        <br><br><br><br>
<span class="d-flex justify-content-center"><br><br>
  <h4>
   <i class="fas fa-lightbulb"  style="color: 
     {% if Dccurrent[0] > 0.1 %}
       {% if Accurrent[0] > 0.1 %}
         blue
       {% else %}
         green
       {% endif %}
     {% else %}
       black
     {% endif %}; 
     margin-left: 10px;"></i>
</h4>
</span>

  <div class="text-center" >
         <h5> Battery Status</h5>
        </div>
   <!-- battery -->

      <div class="pt-5">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          style="display: none;">
          <symbol id="wave">
            <path
              d="M420,20c21.5-0.4,38.8-2.5,51.1-4.5c13.4-2.2,26.5-5.2,27.3-5.4C514,6.5,518,4.7,528.5,2.7c7.1-1.3,17.9-2.8,31.5-2.7c0,0,0,0,0,0v20H420z">
            </path>
            <path
              d="M420,20c-21.5-0.4-38.8-2.5-51.1-4.5c-13.4-2.2-26.5-5.2-27.3-5.4C326,6.5,322,4.7,311.5,2.7C304.3,1.4,293.6-0.1,280,0c0,0,0,0,0,0v20H420z">
            </path>
            <path
              d="M140,20c21.5-0.4,38.8-2.5,51.1-4.5c13.4-2.2,26.5-5.2,27.3-5.4C234,6.5,238,4.7,248.5,2.7c7.1-1.3,17.9-2.8,31.5-2.7c0,0,0,0,0,0v20H140z">
            </path>
            <path
              d="M140,20c-21.5-0.4-38.8-2.5-51.1-4.5c-13.4-2.2-26.5-5.2-27.3-5.4C46,6.5,42,4.7,31.5,2.7C24.3,1.4,13.6-0.1,0,0c0,0,0,0,0,0l0,20H140z">
            </path>
          </symbol>
        </svg>
        <!-- battery percentage animation -->
        <div class="box">
          <div class="percent">
            <div class="percentNum" id="count">0</div>
            <div class="percentB">%</div>
          </div>
          <div id="water" class="water">
            <svg viewBox="0 0 560 20" class="water_wave water_wave_back">
              <use xlink:href="#wave"></use>
            </svg>
            <svg viewBox="0 0 560 20" class="water_wave water_wave_front">
              <use xlink:href="#wave"></use>
            </svg>
          </div>
        </div>
      </div>
      </div>
</div>    
<div class="con_small">
      <div class="half-width" style="text-align: center">
        <br />
       
        <span  class="text-center mt-2 sizebox powerstationparameters">
        Power Station Input Parameters
        </span><br>
    <a class="btn btn-outline-primary" href="{{ url_for('tables', device=deviceid) }}">Details</a>

      </div>
      <!--  -->
  
      <!--  -->
      <!-- battery -->

      <div class="">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          style="display: none;">
          <symbol id="wave">
            <path
              d="M420,20c21.5-0.4,38.8-2.5,51.1-4.5c13.4-2.2,26.5-5.2,27.3-5.4C514,6.5,518,4.7,528.5,2.7c7.1-1.3,17.9-2.8,31.5-2.7c0,0,0,0,0,0v20H420z">
            </path>
            <path
              d="M420,20c-21.5-0.4-38.8-2.5-51.1-4.5c-13.4-2.2-26.5-5.2-27.3-5.4C326,6.5,322,4.7,311.5,2.7C304.3,1.4,293.6-0.1,280,0c0,0,0,0,0,0v20H420z">
            </path>
            <path
              d="M140,20c21.5-0.4,38.8-2.5,51.1-4.5c13.4-2.2,26.5-5.2,27.3-5.4C234,6.5,238,4.7,248.5,2.7c7.1-1.3,17.9-2.8,31.5-2.7c0,0,0,0,0,0v20H140z">
            </path>
            <path
              d="M140,20c-21.5-0.4-38.8-2.5-51.1-4.5c-13.4-2.2-26.5-5.2-27.3-5.4C46,6.5,42,4.7,31.5,2.7C24.3,1.4,13.6-0.1,0,0c0,0,0,0,0,0l0,20H140z">
            </path>
          </symbol>
        </svg>
        <!-- battery percentage animation -->
        <!-- <div class="box">
          <div class="percent">
            <div class="percentNum" id="count">0</div>
            <div class="percentB">%</div>
          </div>
          <div id="water" class="water">
            <svg viewBox="0 0 560 20" class="water_wave water_wave_back">
              <use xlink:href="#wave"></use>
            </svg>
            <svg viewBox="0 0 560 20" class="water_wave water_wave_front">
              <use xlink:href="#wave"></use>
            </svg>
          </div>
        </div> -->
      </div>

      <!-- end battery -->
    

      <!--  -->
      <div class="half-width" style="text-align: center">
        <br />
        <span  class="text-center mt-2 sizebox powerstationparameters">
                 Power Station Output Parameters

        </span>
         <br>
    <a class="btn btn-outline-primary" href="{{ url_for('tables', device=deviceid) }}">Details</a>
        <br />
     
      </div>
    </div>

    <!-- next d-flex -->
    
    <div class="acdcflexdiv">

      <div class="dcdiv ">
        <!-- grid input -->
          <div class="mt-5"
        style=" display: flex; justify-content: space-around; 
        align-items: center; 
        flex-wrap: wrap;">
          <div class="text-center parameters"><br><p>AC Grid Input </p></div>

          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Accurrent[4] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">V</span>
              </h4>
            </div>
            <div class="Voltage"> Voltage </div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4> {{Accurrent[0] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">
                  A
                </span>
              </h4>
            </div>
            <div class="Voltage">Current</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Accurrent[2]}}
                <span class="ms-2 mt-4" style="font-size: 15px">W</span>
              </h4>
            </div>
            <div class="Voltage"> Power </div>
          </div>
        </div>
        
        <br><br>
        <!-- inverter output -->
        <div class=""
        style=" display: flex; justify-content: space-around; 
        align-items: center; 
        flex-wrap: wrap;">
          <div class="text-center parameters"><p>Solar Panel Input </p></div>

          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Dccurrent[6] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">V</span>
              </h4>
            </div>
            <div class="Voltage"> Voltage </div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Dccurrent[7] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">
                  A
                </span>
              </h4>
            </div>
            <div class="Voltage">Current</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Dccurrent[8]}}
                <span class="ms-2 mt-4" style="font-size: 15px">W</span>
              </h4>
            </div>
            <div class="Voltage"> Power </div>
          </div>
        </div>
<br><br>
        <!-- battery charging -->
   <!-- Battery -->
        <div class="" style=" display: flex; justify-content: space-around; 
        align-items: center; 
        flex-wrap: wrap;">
          <div class="text-center parameters"><p>Battery Charging</p></div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Dccurrent[4] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">V</span>
              </h4>
            </div>
            <div class="Voltage">Voltage</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4> {{Dccurrent[0] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">A</span>
              </h4>
            </div>
            <div class="Voltage">Current</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Dccurrent[2] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">W</span>
              </h4>
            </div>
            <div class="Voltage">Power </div>
          </div>
        </div>
             <br><br>
      </div>


      <div class="dcdiv">
         <!-- inverter output -->
        <div class="mt-5"
        style=" display: flex; justify-content: space-around; 
        align-items: center; 
        flex-wrap: wrap;">
          <div class="text-center parameters"><br><p>P S Output </p></div>

          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{inverterdata[3] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">V</span>
              </h4>
            </div>
            <div class="Voltage"> Voltage </div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4> {{inverterdata[0]}}
                <span class="ms-2 mt-4" style="font-size: 15px">
                  A
                </span>
              </h4>
            </div>
            <div class="Voltage">Current</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{inverterdata[2]}}
                <span class="ms-2 mt-4" style="font-size: 15px">W</span>
              </h4>
            </div>
            <div class="Voltage"> Power </div>
          </div>
        </div>
<br><br>
        <!-- dc -->
        <div class=" " style=" display: flex; justify-content: space-around; 
        align-items: center; 
        flex-wrap: wrap;">
          <div class="text-center parameters"><p>Battery Discharging</p></div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{Dccurrent[4] | round(2) }}
                <span class="ms-2 mt-4" style="font-size: 15px">V</span>
              </h4>
            </div>
            <div class="Voltage">Voltage</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4> {{battery_discharging_current[0]}}
                <span class="ms-2 mt-4" style="font-size: 15px">A</span>
              </h4>
            </div>
            <div class="Voltage">Current</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>{{ (Dccurrent[4] * battery_discharging_current[0]) | round(2) }}

                <span class="ms-2 mt-4" style="font-size: 15px">W</span>
              </h4>
            </div>
            <div class="Voltage"> Power </div>
          </div>
        </div>
        <br><br>
       
        <!-- Grid Input -->
    <div class=""
        style=" display: flex; justify-content: space-around; 
        align-items: center; 
        flex-wrap: wrap;">
          <div class="text-center parameters"><p class="mb-2"> Power <br> Consumed Today </p></div>

          <div class="dcbox1">
            <div class="voltageValues">
              <h4>0.0
                <span class="ms-2 mt-4" style="font-size: 15px">W</span>
              </h4>
            </div>
            <div class="Voltage"> Grid </div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>0.0
                <span class="ms-2 mt-4" style="font-size: 15px">
                  W
                </span>
              </h4>
            </div>
            <div class="Voltage">Solar Panel</div>
          </div>
          <div class="dcbox1">
            <div class="voltageValues">
              <h4>0.0
                <span class="ms-2 mt-4" style="font-size: 15px">W</span>
              </h4>
            </div>
            <div class="Voltage"> Total Power </div>
          </div>
        </div>
      </div>
     
    </div>
   <!-- end panel -->
   
   <!-- date -->
    <div class="full-width4">
      <label><b>Date Range For Analysis</b></label>
      <div class="dates">Both dates are mandatory</div>
      <div class="datess">
        <div>
          <label for="start_date"><b>Start Date
              <span class="required-asterisk" style="color: red">*</span></b></label><br />
          <input style="width: 250px" type="date" value="{{ today_date }}" id="start_date" name="start_date" />
        </div>
        <div>
          <label for="end_date"><b>End Date
              <span class="required-asterisk" style="color: red">*</span></b></label><br />
          <input style="width: 250px" type="date" value="{{ today_date }}" id="end_date" name="end_date" />
        </div>
      </div>
      <br>
   
      <!-- Graphs -->
   <!-- Inverter parameters -->
      <div class="chart1">
        <h3 class="" >  Inverter Output Parameters </h3>
       
        <canvas id="live1" style="height: 340px; width: 100%; padding-right: 30px;"></canvas>
        </canvas>
      </div>
      <!-- panel graph -->
        <div class="chart1">
        <h3 class="" > Solar Panel Parameters</h3>
        <canvas id="live1" style="height: 340px; width: 100%; padding-right: 30px;"></canvas>
        
        <!-- <canvas id="live3" style="height: 340px; width: 100%; padding-right: 30px;"></canvas> -->
        </canvas>
      </div>
      
      <!--battery  -->
          <div class="chart1">
        <h3 class="" > Battery Parameters</h3>
        <canvas id="live1" style="height: 340px; width: 100%; padding-right: 30px;"></canvas>
      
        <!-- <canvas id="live4" style="height: 340px; width: 100%; padding-right: 30px;"></canvas> -->
        </canvas>
      </div>
      <!-- grid  -->
      <div class="chart1">
        <h3>Grid Parameters</h3>
       
        <canvas id="live2" style="height: 340px; width: 100%; padding-right: 30px;"></canvas>
        </canvas>
      </div> 
    
    
   
      <br>

  <!-- Footer -->
 <br><br><br><br>
   <div class="footer">
    <p class="ms-5" style="margin-left: 35px;"> Copyright © 2024 <a href="" target="_blank" class="linnk">Skilancer Solar</a> . All rights reserved.</p>
    <p style="margin-right: 20px;" class="version">Version 1.0.1</p>
  </div>
    <!--end div  -->


  <!--scripts for battery -->
  <script>
    const batteryChargeFull = parseInt("{{ battery_chargefull }}", 10);

    const cnt = document.getElementById("count");
    const water = document.getElementById("water");

    let currentPercentage = 0;
    const interval = setInterval(function () {
      if (currentPercentage < batteryChargeFull) {
        currentPercentage++;
        cnt.innerHTML = currentPercentage;
        water.style.transform = `translate(0, ${(100 - currentPercentage)}%)`;
      } else {
        clearInterval(interval);
      }
    }, 60);
  </script>
  <!-- script for graphs -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
 
<!-- graph or inverter output -->
 
  <script>
    // Ensure this is output as a valid string/number by Jinja2
    const id = {{ Dccurrent[5] | tojson }};
    let chart = null;

    function livegraphAc(startDate, endDate) {
      const url = startDate && endDate
        ? `/livegraphdc/${id}?start_date=${startDate}&end_date=${endDate}`
        : `/livegraphdc/${id}`;

      console.log("Fetching URL:", url);

      fetch(url)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }
          return response.json();
        })
        .then((data) => {
          console.log("Fetched data:", data);
          if (!Array.isArray(data)) {
            throw new Error("Data is not an array.");
          }

          const labels = data.map((item) => new Date(item.timestamp));
          const voltageValues = data.map((item) => item.Inverter_voltage);
          const currentValues = data.map((item) => item.Inverter_current);
          const powerValues = data.map((item) => item.Inverter_voltage * item.Inverter_current);

          if (chart) {
            chart.destroy();
          }

          const ctx = document.getElementById("live1").getContext("2d");
          chart = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "AC Voltage (V)",
                  data: voltageValues,
                  borderColor: "#207bff",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y1",
                },
                {
                  label: "AC Current (A)",
                  data: currentValues,
                  borderColor: "#db2b39",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y2",
                },
                {
                  label: "Power (W)",
                  data: powerValues,
                  borderColor: "#f3a712",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y1",
                },
              ],
            },
            options: {
              responsive: true,
              scales: {
                x: {
                  type: "time",
                  time: {
                    unit: "hour",
                    tooltipFormat: "MMM d, h:mm a",
                  },
                  title: {
                    display: true,
                    text: "Time",
                  },
                  grid: {
                    display: false,
                  },
                },
                y1: {
                  beginAtZero: true,
                  grid: {
                    display: false,
                  },
                  title: {
                    display: true,
                    text: "Voltage & Power (V/W)",
                  },
                },
                y2: {
                  beginAtZero: true,
                  position: "right",
                  grid: {
                    drawOnChartArea: true,
                  },
                  title: {
                    display: true,
                    text: "Current (A)",
                  },
                },
              },
            },
          });
        })
        .catch((error) => {
          console.error("Error fetching graph data:", error);
        });
    }

    // Initial graph load
    livegraphAc();

    // Update graph on date change
    document.getElementById("start_date").addEventListener("change", updateGraph);
    document.getElementById("end_date").addEventListener("change", updateGraph);

    function updateGraph() {
      const startDate = document.getElementById("start_date").value;
      const endDate = document.getElementById("end_date").value;
      livegraphAc(startDate, endDate);
    }
  </script>
<!-- graph panel output dc -->

  <!-- <script>
    const id_panel = "{{ Dccurrent[5]}}";
    let chart1 = null;

    function livegraphAc(startDate, endDate) {
      const url = startDate && endDate
        ? `/livegraphpanel/${id_panel}?start_date=${startDate}&end_date=${endDate}`
        : `/livegraphpanel/${id_panel}`;

      console.log("Fetching URL:", url);

      fetch(url)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }
          return response.json();
        })
        .then((data) => {
          console.log("Fetched data:", data);
          if (!Array.isArray(data)) {
            throw new Error("Data is not an array.");
          }

          const labels = data.map((item) => new Date(item.timestamp));
          const voltageValues = data.map((item) => item.panel_voltage);
          const currentValues = data.map((item) => item.panel_current);
          const powerValues = data.map((item) => item.Panel_Power);

          if (chart1) {
            chart1.destroy();
          }

          const ctx = document.getElementById("live3").getContext("2d");
          chart = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Panel Voltage (V)",
                  data: voltageValues,
                  borderColor: "#207bff",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y1",
                },
                {
                  label: "Panel Current (A)",
                  data: currentValues,
                  borderColor: "#db2b39",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y2",
                },
                {
                  label: "Power (W)",
                  data: powerValues,
                  borderColor: "#f3a712",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y1",
                },
              ],
            },
            options: {
              responsive: true,
              scales: {
                x: {
                  type: "time",
                  time: {
                    unit: "hour",
                    tooltipFormat: "MMM d, h:mm a",
                  },
                  title: {
                    display: true,
                    text: "Time",
                  },
                  grid: {
                    display: false,
                  },
                },
                y1: {
                  beginAtZero: true,
                  grid: {
                    display: false,
                  },
                  title: {
                    display: true,
                    text: "Voltage & Power (V/W)",
                  },
                },
                y2: {
                  beginAtZero: true,
                  position: "right",
                  grid: {
                    drawOnChartArea: true,
                  },
                  title: {
                    display: true,
                    text: "Current (A)",
                  },
                },
              },
            },
          });
        })
        .catch((error) => {
          console.error("Error fetching graph data:", error);
        });
    }

    // Initial graph load
    livegraphAc();

    // Update graph on date change
    document.getElementById("start_date").addEventListener("change", updateGraph);
    document.getElementById("end_date").addEventListener("change", updateGraph);

    function updateGraph() {
      const startDate = document.getElementById("start_date").value;
      const endDate = document.getElementById("end_date").value;
      livegraphAc(startDate, endDate);
    }
  </script> -->
<!-- battery out put -->
<!-- <script>
  const id_battery = "{{ Dccurrent[5] }}";
  let chart2 = null;

  function livegraphAc(startDate, endDate) {
    const url = startDate && endDate
      ? `/livegraphbattery/${id_battery}?start_date=${startDate}&end_date=${endDate}`
      : `/livegraphbattery/${id_battery}`;

    console.log("Fetching URL:", url);

    fetch(url)
      .then((response) => {
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json();
      })
      .then((data) => {
        console.log("Fetched data:", data);
        if (!Array.isArray(data)) {
          throw new Error("Data is not an array.");
        }

        const labels = data.map((item) => new Date(item.timestamp));
        const voltageValues = data.map((item) => item.Dc_Voltage);
        const currentValues = data.map((item) => item.Dc_Current);

        if (chart2) {
          chart2.destroy();
        }

        const ctx = document.getElementById("live4").getContext("2d");
        chart2 = new Chart(ctx, {
          type: "line",
          data: {
            labels: labels,
            datasets: [
              {
                label: "Battery Voltage (V)",
                data: voltageValues,
                borderColor: "#207bff",
                backgroundColor: "rgba(0, 0, 0, 0)",
                borderWidth: 2,
                fill: false,
                tension: 0.3,
                yAxisID: "y1",
              },
              {
                label: "Battery Current (A)",
                data: currentValues,
                borderColor: "#db2b39",
                backgroundColor: "rgba(0, 0, 0, 0)",
                borderWidth: 2,
                fill: false,
                tension: 0.3,
                yAxisID: "y2",
              }
            ],
          },
          options: {
            responsive: true,
            scales: {
              x: {
                type: "time",
                time: {
                  unit: "hour",
                  tooltipFormat: "MMM d, h:mm a",
                },
                title: {
                  display: true,
                  text: "Time",
                },
                grid: {
                  display: false,
                },
              },
              y1: {
                beginAtZero: true,
                grid: {
                  display: false,
                },
                title: {
                  display: true,
                  text: "Voltage (V)",
                },
              },
              y2: {
                beginAtZero: true,
                position: "right",
                grid: {
                  drawOnChartArea: true,
                },
                title: {
                  display: true,
                  text: "Current (A)",
                },
              },
            },
          },
        });
      })
      .catch((error) => {
        console.error("Error fetching graph data:", error);
      });
  }

  // Initial graph load
  livegraphAc();

  // Update graph on date change
  document.getElementById("start_date").addEventListener("change", updateGraph);
  document.getElementById("end_date").addEventListener("change", updateGraph);

  function updateGraph() {
    const startDate = document.getElementById("start_date").value;
    const endDate = document.getElementById("end_date").value;
    livegraphAc(startDate, endDate);
  }
</script> -->


  <!--Graph for grid AC Data -->
  <script>
    const id1 = "{{Accurrent[5]}}";
    let chart5 = null;
    function livegraphAc(startDate, endDate) {
      const url =
        startDate && endDate
          ? `/livegraphac/${id1}?start_date=${startDate}&end_date=${endDate}`
          : `/livegraphac/${id1}`;

      fetch(url)
        .then((response) => {
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }
          return response.json();
        })
        .then((data) => {
          if (!Array.isArray(data)) {
            throw new Error("Data is not an array.");
          }

          const labels = data.map((item) => new Date(item.timestamp));
          const voltageValues = data.map((item) => item.Voltage);
          const currentValues = data.map((item) => item.Current);
          const powerValues = data.map((item) => item.Voltage * item.Current);

          if (chart5) {
            chart5.destroy();
          }

          const ctx = document.getElementById("live2").getContext("2d");
          chart5 = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "AC Voltage (V)",
                  data: voltageValues,
                  borderColor: "#207bff",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y1",
                },
                {
                  label: "AC Current (A)",
                  data: currentValues,
                  borderColor: "#db2b39",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y2",
                },
                {
                  label: "Power (W)",
                  data: powerValues,
                  borderColor: "#f3a712",
                  backgroundColor: "rgba(0, 0, 0, 0)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.3,
                  yAxisID: "y1",
                },
              ],
            },
            options: {
              scales: {
                x: {
                  type: "time",
                  time: {
                    unit: "hour",
                    tooltipFormat: "MMM d, h:mm a",
                  },
                  grid: {
                    display: false,
                  },
                },
                y1: {
                  beginAtZero: true,
                  grid: {
                    display: false,
                  },
                  title: {
                    display: true,
                    text: "Voltage & Power (V/W)",
                  },
                },
                y2: {
                  beginAtZero: true,
                  position: "right",
                  grid: {
                    drawOnChartArea: true,
                  },
                  title: {
                    display: true,
                    text: "Current (A)",
                  },
                },
              },
            },
          });
        })
        .catch((error) => {
          console.error("Error fetching graph data:", error);
        });
    }

    livegraphAc();

    document
      .getElementById("start_date")
      .addEventListener("change", updateGraph);
    document
      .getElementById("end_date")
      .addEventListener("change", updateGraph);

    function updateGraph() {
      const startDate = document.getElementById("start_date").value;
      const endDate = document.getElementById("end_date").value;
      livegraphAc(startDate, endDate);
    }
</script>

  <!--Graph for DC avg Data -->
  <script>

document.addEventListener('DOMContentLoaded', function () {
  const ctx = document.getElementById('myChart1').getContext('2d');
  let chart = null;

  function fetchAndUpdateChart(startDate, endDate) {
    fetch(`/dckwh_graph?robot_id={{ Accurrent[5] }}&start_date=${startDate}&end_date=${endDate}`)
      .then(response => {
        if (!response.ok) {
          return response.json().then(err => {
            throw new Error(err.message || 'No data available for the selected dates');
          });
        }
        return response.json();
      })
      .then(data => {
        if (!data || data.length === 0) {
          data = [{ date: startDate, dc_avg: 0 }];  // Placeholder data for empty graph
        }

        let dates = data.map(item => item.date || 'N/A');
        let dc_kwh = data.map(item => item.dc_avg !== null ? item.dc_avg : 0);

        if (!chart) {
          chart = new Chart(ctx, {
            type: 'bar',
            data: {
              labels: dates,
              datasets: [{
                label: 'Kwh Dc',
                data: dc_kwh,
                backgroundColor: '#FF4191',
                yAxisID: 'y-left',
              }]
            },
            options: {
              interaction: { mode: 'index', intersect: false },
              plugins: {
                tooltip: {
                  callbacks: {
                    label: function (tooltipItem) {
                      return `${tooltipItem.dataset.label}: ${tooltipItem.raw}`;
                    }
                  }
                }
              },
              scales: {
                'y-left': {
                  type: 'linear',
                  position: 'left',
                  beginAtZero: true,
                  title: { display: true, text: 'Dc Kwh', color: '#FF4191' },
                  ticks: { color: '#FF4191' },
                  grid: { color: 'rgba(0,0,0,0.1)' }
                }
              }
            }
          });
        } else {
          chart.data.labels = dates;
          chart.data.datasets[0].data = dc_kwh;
          chart.update();
        }
      })
      .catch(error => {
       
        if (!chart) {
          chart = new Chart(ctx, {
            type: 'bar',
            data: {
              labels: ['N/A'],
              datasets: [{
                label: 'Kwh Dc',
                data: [0],
                backgroundColor: '#FF4191',
                yAxisID: 'y-left',
              }]
            },
            options: {
              scales: {
                'y-left': {
                  type: 'linear',
                  position: 'left',
                  beginAtZero: true,
                  title: { display: true, text: 'Dc Kwh', color: '#FF4191' }
                }
              }
            }
          });
        }
      });
  }

  // Default date range setup
  const today = new Date().toISOString().split('T')[0];
  const sevenDaysAgo = new Date();
  sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
  const sevenDaysAgoStr = sevenDaysAgo.toISOString().split('T')[0];

  // Set default values for input fields if empty
  const startDateInput = document.getElementById('start_date');
  const endDateInput = document.getElementById('end_date');

  startDateInput.value = startDateInput.value || sevenDaysAgoStr;
  endDateInput.value = endDateInput.value || today;

  fetchAndUpdateChart(startDateInput.value, endDateInput.value);

  // Listen for date input changes and update chart dynamically
  function updateChartOnDateChange() {
    const startDate = startDateInput.value;
    const endDate = endDateInput.value;
    if (startDate && endDate) {
      fetchAndUpdateChart(startDate, endDate);
    }
  }

  startDateInput.addEventListener('change', updateChartOnDateChange);
  endDateInput.addEventListener('change', updateChartOnDateChange);
});

    </script>
  <!--Graph for AC avg Data -->
  <script>

    document.addEventListener('DOMContentLoaded', function () {
      const ctx = document.getElementById('myChart2').getContext('2d');
      let chart = null;
    
      function fetchAndUpdateChart(startDate, endDate) {
        fetch(`/ackwh_graph?robot_id={{ Accurrent[5] }}&start_date=${startDate}&end_date=${endDate}`)
          .then(response => {
            if (!response.ok) {
              return response.json().then(err => {
                throw new Error(err.message || 'No data available for the selected dates');
              });
            }
            return response.json();
          })
          .then(data => {
            if (!data || data.length === 0) {
              data = [{ date: startDate, ac_avg: 0 }];  
            }
    
            let dates = data.map(item => item.date || 'N/A');
            let ac_kwh = data.map(item => item.ac_avg !== null ? item.ac_avg : 0);
    
            if (!chart) {
              chart = new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: dates,
                  datasets: [{
                    label: 'Kwh Ac',
                    data: dc_kwh,
                    backgroundColor: '#FF4191',
                    yAxisID: 'y-left',
                  }]
                },
                options: {
                  interaction: { mode: 'index', intersect: false },
                  plugins: {
                    tooltip: {
                      callbacks: {
                        label: function (tooltipItem) {
                          return `${tooltipItem.dataset.label}: ${tooltipItem.raw}`;
                        }
                      }
                    }
                  },
                  scales: {
                    'y-left': {
                      type: 'linear',
                      position: 'left',
                      beginAtZero: true,
                      title: { display: true, text: 'Ac Kwh', color: '#FF4191' },
                      ticks: { color: '#FF4191' },
                      grid: { color: 'rgba(0,0,0,0.1)' }
                    }
                  }
                }
              });
            } else {
              chart.data.labels = dates;
              chart.data.datasets[0].data = ac_kwh;
              chart.update();
            }
          })
          .catch(error => {
           
            if (!chart) {
              chart = new Chart(ctx, {
                type: 'bar',
                data: {
                  labels: ['N/A'],
                  datasets: [{
                    label: 'Kwh Ac',
                    data: [0],
                    backgroundColor: '#FF4191',
                    yAxisID: 'y-left',
                  }]
                },
                options: {
                  scales: {
                    'y-left': {
                      type: 'linear',
                      position: 'left',
                      beginAtZero: true,
                      title: { display: true, text: 'Ac Kwh', color: '#FF4191' }
                    }
                  }
                }
              });
            }
          });
      }
    
      // Default date range setup
      const today = new Date().toISOString().split('T')[0];
      const sevenDaysAgo = new Date();
      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
      const sevenDaysAgoStr = sevenDaysAgo.toISOString().split('T')[0];
    
      // Set default values for input fields if empty
      const startDateInput = document.getElementById('start_date');
      const endDateInput = document.getElementById('end_date');
    
      startDateInput.value = startDateInput.value || sevenDaysAgoStr;
      endDateInput.value = endDateInput.value || today;
    
      fetchAndUpdateChart(startDateInput.value, endDateInput.value);
    
      // Listen for date input changes and update chart dynamically
      function updateChartOnDateChange() {
        const startDate = startDateInput.value;
        const endDate = endDateInput.value;
        if (startDate && endDate) {
          fetchAndUpdateChart(startDate, endDate);
        }
      }
    
      startDateInput.addEventListener('change', updateChartOnDateChange);
      endDateInput.addEventListener('change', updateChartOnDateChange);
    });
    
        </script>
    <!--table  -->
    <script>
      $(document).ready(function () {
        var table = $('#example21').DataTable({
          "pageLength": 10,
          "order": [
            [1, "desc"]
          ],
          "drawCallback": function (settings) {
            $('#example21 thead').css({
              'background-color': '#045B62',
              'color': 'white',
              'border': '1px solid #F7F6F7',
            });
            $('#example21_paginate').css({
              'text-align': 'center',
              'cursor': 'pointer'
            });
            $('#example21_previous').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '2px 0 0 2px',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('#example21_next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0 2px 2px 0',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('.paginate_button').not('.previous, .next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0',
              'color': '#999699',
              'display': 'inline-block',
              'margin': '0 -0px 0 -0px'
            });
  
            $('.paginate_button.current').css({
              'background-color': '#007BFF',
              'color': 'white',
              'border': '1px solid #007BFF'
            });
          }
        });
  
        $('#example21_filter').css({ 'margin-left': '75%' });
  
        $('#searchInput').on('keyup', function () {
          table.search($(this).val()).draw();
        });
      });
    </script>
  
    <script>
      $(document).ready(function () {
        var table = $('#example2').DataTable({
          "pageLength": 10,
          "order": [
            [1, "desc"]
          ],
          "drawCallback": function (settings) {
            $('#example2 thead').css({
              'background-color': '#045B62',
              'color': 'white',
              'border': '1px solid #F7F6F7',
            });
            $('#example2_paginate').css({
              'text-align': 'center',
              'cursor': 'pointer'
            });
            $('#example2_previous').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '2px 0 0 2px',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('#example2_next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0 2px 2px 0',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('.paginate_button').not('.previous, .next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0',
              'color': '#999699',
              'display': 'inline-block',
              'margin': '0 -0px 0 -0px'
            });
  
            $('.paginate_button.current').css({
              'background-color': '#007BFF',
              'color': 'white',
              'border': '1px solid #007BFF'
            });
          }
        });
  
        $('#example2_filter').css({ 'margin-left': '75%' });
  
        $('#searchInput').on('keyup', function () {
          table.search($(this).val()).draw();
        });
      });
    </script>
  
    <script>
      $(document).ready(function () {
        var table = $('#example3').DataTable({
          "pageLength": 10,
          "order": [
            [1, "desc"]
          ],
          "drawCallback": function (settings) {
            $('#example3 thead').css({
              'background-color': '#045B62',
              'color': 'white',
              'border': '1px solid #F7F6F7',
            });
            $('#example3_paginate').css({
              'text-align': 'center',
              'cursor': 'pointer'
            });
            $('#example3_previous').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '2px 0 0 2px',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('#example3_next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0 2px 2px 0',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('.paginate_button').not('.previous, .next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0',
              'color': '#999699',
              'display': 'inline-block',
              'margin': '0 -0px 0 -0px'
            });
  
            $('.paginate_button.current').css({
              'background-color': '#007BFF',
              'color': 'white',
              'border': '1px solid #007BFF'
            });
          }
        });
  
        $('#example3_filter').css({ 'margin-left': '75%' });
  
        $('#searchInput').on('keyup', function () {
          table.search($(this).val()).draw();
        });
      });
    </script>

  <!-- battery discharging -->
 <script>
      $(document).ready(function () {
        var table = $('#examplebtdc').DataTable({
          "pageLength": 10,
          "order": [
            [1, "desc"]
          ],
          "drawCallback": function (settings) {
            $('#examplebtdc thead').css({
              'background-color': '#045B62',
              'color': 'white',
              'border': '1px solid #F7F6F7',
            });
            $('#examplebtdc_paginate').css({
              'text-align': 'center',
              'cursor': 'pointer'
            });
            $('#examplebtdc_previous').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '2px 0 0 2px',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('#examplebtdc_next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0 2px 2px 0',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('.paginate_button').not('.previous, .next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0',
              'color': '#999699',
              'display': 'inline-block',
              'margin': '0 -0px 0 -0px'
            });
  
            $('.paginate_button.current').css({
              'background-color': '#007BFF',
              'color': 'white',
              'border': '1px solid #007BFF'
            });
          }
        });
  
        $('#examplebtdc_filter').css({ 'margin-left': '75%' });
  
        $('#searchInput').on('keyup', function () {
          table.search($(this).val()).draw();
        });
      });
    </script>
  
  <!--  -->
    <script>
      $(document).ready(function () {
        var table = $('#example4').DataTable({
          "pageLength": 10,
          "order": [
            [1, "desc"]
          ],
          "drawCallback": function (settings) {
            $('#example4 thead').css({
              'background-color': '#045B62',
              'color': 'white',
              'border': '1px solid #F7F6F7',
            });
            $('#example4_paginate').css({
              'text-align': 'center',
              'cursor': 'pointer'
            });
            $('#example4_previous').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '2px 0 0 2px',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('#example4_next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0 2px 2px 0',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('.paginate_button').not('.previous, .next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0',
              'color': '#999699',
              'display': 'inline-block',
              'margin': '0 -0px 0 -0px'
            });
  
            $('.paginate_button.current').css({
              'background-color': '#007BFF',
              'color': 'white',
              'border': '1px solid #007BFF'
            });
          }
        });
  
        $('#example4_filter').css({ 'margin-left': '75%' });
  
        $('#searchInput').on('keyup', function () {
          table.search($(this).val()).draw();
        });
      });
    </script>
  
    <script>
      $(document).ready(function () {
        var table = $('#example5').DataTable({
          "pageLength": 10,
          "order": [
            [1, "desc"]
          ],
          "drawCallback": function (settings) {
            $('#example5 thead').css({
              'background-color': '#045B62',
              'color': 'white',
              'border': '1px solid #F7F6F7',
            });
            $('#example5_paginate').css({
              'text-align': 'center',
              'cursor': 'pointer'
            });
            $('#example5_previous').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '2px 0 0 2px',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('#example5_next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0 2px 2px 0',
              'display': 'inline-block',
              'color': '#007BFF',
              'margin': '0'
            });
            $('.paginate_button').not('.previous, .next').css({
              'padding': '4px 8px',
              'border': '1px solid #e3e3e3',
              'border-radius': '0',
              'color': '#999699',
              'display': 'inline-block',
              'margin': '0 -0px 0 -0px'
            });
  
            $('.paginate_button.current').css({
              'background-color': '#007BFF',
              'color': 'white',
              'border': '1px solid #007BFF'
            });
          }
        });
  
        $('#example5_filter').css({ 'margin-left': '75%' });
  
        $('#searchInput').on('keyup', function () {
          table.search($(this).val()).draw();
        });
      });
    </script>
  
    
  <!-- logout -->
  <script>
   
        function logout() {
          fetch("/logout", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
          })
            .then((response) => {
              if (response.ok) {
                window.location.href = "/";
              } else {
                window.location.href = "/";
              }
            })
            .catch((error) => {
              console.error("Logout failed:", error);
              window.location.href = "/";
            });
        }

        function preventBack() {
          window.history.replaceState(null, null, window.location.href);
          window.onpopstate = function () {
            window.history.replaceState(null, null, window.location.href);
            window.location.href = "/";
          };
        }
        preventBack();
  </script>

  <!-- for automatically logout -->
  <script>
    var timeout;
    var logoutTime = 20 * 60 * 1000; // 20 minutes

    function resetTimer() {
      clearTimeout(timeout);
      timeout = setTimeout(logout, logoutTime);
    }

    function logout() {
      fetch("/logout", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((response) => {
          if (response.ok) {
            window.location.href = "/";
          } else {
            window.location.href = "/";
          }
        })
        .catch((error) => {
          console.error("Logout failed:", error);
          window.location.href = "/";
        });
    }

    document.onload = resetTimer;
    document.onmousemove = resetTimer;
    document.onkeypress = resetTimer;

    resetTimer();

    function preventBack() {
      window.history.replaceState(null, null, window.location.href);
      window.onpopstate = function () {
        window.history.replaceState(null, null, window.location.href);
        window.location.href = "/";
      };
    }

    if (window.location.pathname === "/") {
      preventBack();
    }
  </script>

  <!-- script for disable futue dates -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const today = new Date().toISOString().split("T")[0];

      document.getElementById("start_date").setAttribute("max", today);
      document.getElementById("end_date").setAttribute("max", today);
    });
  </script>

</body>

</html>